<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Anusha World ‚ù§Ô∏è</title>
    <style>
        /* Force GPU usage to stop lag */
        * { -webkit-backface-visibility: hidden; -webkit-transform: translateZ(0); }
        
        body { background: #ffafbd; margin: 0; overflow: hidden; font-family: 'Arial', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; touch-action: none; position: fixed; width: 100%; }
        
        #game-wrapper { position: relative; width: 100%; max-width: 800px; height: 450px; background: #87CEEB; overflow: hidden; }
        canvas { display: block; width: 100%; height: 100%; image-rendering: pixelated; }
        
        .screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255, 175, 189, 0.95); z-index: 100; text-align: center; }
        h1 { color: #fff; text-shadow: 2px 2px #ff4d6d; margin-bottom: 20px; }
        button { padding: 15px 40px; font-size: 20px; background: #ff4d6d; color: white; border: none; border-radius: 30px; cursor: pointer; box-shadow: 0 5px #c9184a; }
        
        #touch-controls { position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: space-between; padding: 0 20px; box-sizing: border-box; z-index: 50; pointer-events: none; }
        .t-btn { width: 75px; height: 75px; background: rgba(255,255,255,0.4); border-radius: 50%; pointer-events: auto; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; border: 2px solid white; -webkit-user-select: none; user-select: none; }
    </style>
</head>
<body>

<div id="game-wrapper">
    <canvas id="gameCanvas"></canvas>
    
    <div id="start-screen" class="screen">
        <h1>Super Anusha World</h1>
        <button id="start-btn">START ADVENTURE</button>
    </div>

    <div id="victory-screen" class="screen" style="display:none;">
        <h1 style="font-size: 40px;">‚ù§Ô∏è ANUSHA ‚ù§Ô∏è</h1>
        <h2 style="color: #ff4d6d;">Will you be my Valentine?</h2>
        <button onclick="location.reload()">PLAY AGAIN</button>
    </div>

    <div id="touch-controls">
        <div style="display:flex; gap:15px;">
            <div id="btn-left" class="t-btn">‚óÄ</div>
            <div id="btn-right" class="t-btn">‚ñ∂</div>
        </div>
        <div id="btn-jump" class="t-btn">JUMP</div>
    </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = 800;
canvas.height = 450;

let gameActive = false;
let score = 0;
const gravity = 0.8;
const worldWidth = 2200;

const player = { x: 100, y: 300, w: 35, h: 35, vx: 0, vy: 0, speed: 6, jumpPower: -16, grounded: false };
const camera = { x: 0 };
const keys = {};

const platforms = [
    { x: 0, y: 400, w: 600, h: 50 },
    { x: 700, y: 320, w: 250, h: 20 },
    { x: 1050, y: 240, w: 250, h: 20 },
    { x: 1400, y: 350, w: 350, h: 20 },
    { x: 1850, y: 250, w: 400, h: 100 },
];

const hearts = [
    { x: 750, y: 280, collected: false },
    { x: 1100, y: 200, collected: false },
    { x: 1500, y: 310, collected: false },
    { x: 1950, y: 210, collected: false }
];

// Optimized Controls
window.addEventListener('keydown', e => keys[e.code] = true);
window.addEventListener('keyup', e => keys[e.code] = false);

function bindTouch(id, key) {
    const btn = document.getElementById(id);
    btn.addEventListener('touchstart', (e) => { 
        e.preventDefault(); 
        keys[key] = true; 
    }, {passive: false});
    btn.addEventListener('touchend', (e) => { 
        e.preventDefault();
        keys[key] = false; 
    }, {passive: false});
}
bindTouch('btn-left', 'ArrowLeft');
bindTouch('btn-right', 'ArrowRight');
bindTouch('btn-jump', 'ArrowUp');

document.getElementById('start-btn').addEventListener('click', () => {
    document.getElementById('start-screen').style.display = 'none';
    gameActive = true;
    gameLoop();
});

function drawHeart(x, y, size, color) {
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.moveTo(x, y + size/4);
    ctx.quadraticCurveTo(x, y, x - size/2, y);
    ctx.quadraticCurveTo(x - size, y, x - size, y + size/2);
    ctx.quadraticCurveTo(x - size, y + size, x, y + size * 1.5);
    ctx.quadraticCurveTo(x + size, y + size, x + size, y + size/2);
    ctx.quadraticCurveTo(x + size, y, x + size/2, y);
    ctx.quadraticCurveTo(x, y, x, y + size/4);
    ctx.fill();
}

function update() {
    if (keys['ArrowLeft']) player.vx = -player.speed;
    else if (keys['ArrowRight']) player.vx = player.speed;
    else player.vx *= 0.8;

    if (keys['ArrowUp'] && player.grounded) {
        player.vy = player.jumpPower;
        player.grounded = false;
    }

    player.vy += gravity;
    player.x += player.vx;
    player.y += player.vy;

    player.grounded = false;
    platforms.forEach(p => {
        if (player.x + player.w > p.x && player.x < p.x + p.w &&
            player.y + player.h > p.y && player.y + player.h < p.y + p.h && player.vy >= 0) {
            player.y = p.y - player.h;
            player.vy = 0;
            player.grounded = true;
        }
    });

    if (player.x < 0) player.x = 0;
    if (player.x > worldWidth - player.w) player.x = worldWidth - player.w;
    if (player.y > 600) { player.x = 100; player.y = 300; player.vy = 0; } 

    // Instant Camera Tracking
    camera.x = player.x - canvas.width / 2;
    if (camera.x < 0) camera.x = 0;
    if (camera.x > worldWidth - canvas.width) camera.x = worldWidth - canvas.width;

    hearts.forEach(h => {
        if (!h.collected && Math.hypot(player.x - h.x, player.y - h.y) < 40) {
            h.collected = true;
            score++;
        }
    });

    if (score === hearts.length && player.x > 1900) {
        gameActive = false;
        document.getElementById('victory-screen').style.display = 'flex';
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    ctx.translate(-Math.floor(camera.x), 0); // Math.floor prevents jitter

    // Background Clouds
    ctx.fillStyle = "rgba(255,255,255,0.7)";
    for(let i=0; i<15; i++) {
        ctx.beginPath();
        ctx.arc(i*250 + 50, 80 + (i%3*40), 35, 0, Math.PI*2);
        ctx.fill();
    }

    platforms.forEach(p => {
        ctx.fillStyle = "#ff8fa3";
        ctx.fillRect(p.x, p.y, p.w, p.h);
        ctx.fillStyle = "#fff";
        ctx.fillRect(p.x, p.y, p.w, 4);
    });

    hearts.forEach(h => {
        if (!h.collected) drawHeart(h.x, h.y, 14, "#ff4d6d");
    });

    ctx.font = "50px Arial";
    ctx.fillText("üèÅ", 2000, 240);

    drawHeart(player.x + 15, player.y, 15, "#c9184a");
    ctx.restore();

    ctx.fillStyle = "white";
    ctx.font = "bold 22px Arial";
    ctx.fillText(`Love Collected: ${score}/${hearts.length}`, 20, 40);
}

function gameLoop() {
    if (!gameActive) return;
    update();
    draw();
    requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
